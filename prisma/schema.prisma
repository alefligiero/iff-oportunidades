generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             String   @id @default(cuid())
  email          String   @unique
  password       String
  role           Role
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  companyProfile Company?
  studentProfile Student?
}

model Student {
  id          String       @id @default(cuid())
  name        String
  matricula   String       @unique
  userId      String       @unique
  internships Internship[]
  user        User         @relation(fields: [userId], references: [id])
}

model Company {
  id           String       @id @default(cuid())
  name         String
  cnpj         String       @unique
  userId       String       @unique
  description  String?
  location     String?
  user         User         @relation(fields: [userId], references: [id])
  jobVacancies JobVacancy[]
}

model Internship {
  id                        String             @id @default(cuid())
  startDate                 DateTime
  endDate                   DateTime
  status                    InternshipStatus   @default(IN_ANALYSIS)
  type                      InternshipType     @default(DIRECT)
  studentId                 String
  createdAt                 DateTime           @default(now())
  updatedAt                 DateTime           @updatedAt
  advisorProfessorId        String
  advisorProfessorName      String
  companyAddressCep         String
  companyAddressCityState   String
  companyAddressDistrict    String
  companyAddressNumber      String
  companyAddressStreet      String
  companyCnpj               String
  companyEmail              String
  companyName               String
  companyPhone              String
  companyRepresentativeName String
  companyRepresentativeRole String
  dailyHours                String
  insuranceCompany          String
  insuranceCompanyCnpj      String
  insurancePolicyNumber     String
  insuranceProofUrl         String?
  internshipSector          String
  modality                  InternshipModality
  monthlyGrant              Float
  studentAddressCep         String
  studentAddressCityState   String
  studentAddressDistrict    String
  studentAddressNumber      String
  studentAddressStreet      String
  studentCourse             Course
  studentCoursePeriod       String
  studentCpf                String
  studentGender             Gender
  studentPhone              String
  studentSchoolYear         String
  supervisorName            String
  supervisorRole            String
  technicalActivities       String
  transportationGrant       Float
  weeklyHours               Int
  insuranceEndDate          DateTime?
  insuranceStartDate        DateTime?
  rejectionReason           String?
  earlyTerminationApproved  Boolean?
  earlyTerminationHandledAt DateTime?
  earlyTerminationReason    String?
  earlyTerminationRequested Boolean            @default(false)
  documents                 Document[]
  student                   Student            @relation(fields: [studentId], references: [id])
}

model Document {
  id                String         @id @default(cuid())
  type              DocumentType
  status            DocumentStatus @default(PENDING_ANALYSIS)
  fileUrl           String?
  rejectionComments String?
  internshipId      String
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  internship        Internship     @relation(fields: [internshipId], references: [id])
}

model JobVacancy {
  id               String          @id @default(cuid())
  title            String
  description      String
  type             VacancyType
  status           VacancyStatus   @default(PENDING_APPROVAL)
  companyId        String
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt
  remuneration     Float
  workload         Int
  benefits         String?
  contactInfo      String          @default("")
  eligibleCourses  Course[]
  minPeriod        Int?
  modality         VacancyModality @default(PRESENCIAL)
  responsibilities String          @default("")
  softSkills       String          @default("")
  technicalSkills  String          @default("")
  company          Company         @relation(fields: [companyId], references: [id])
}

enum Role {
  ADMIN
  STUDENT
  COMPANY
}

enum Gender {
  MALE
  FEMALE
}

enum Course {
  BSI
  LIC_QUIMICA
  ENG_MECANICA
  TEC_ADM_INTEGRADO
  TEC_ELETRO_INTEGRADO
  TEC_INFO_INTEGRADO
  TEC_QUIMICA_INTEGRADO
  TEC_AUTOMACAO_SUBSEQUENTE
  TEC_ELETRO_CONCOMITANTE
  TEC_MECANICA_CONCOMITANTE
  TEC_QUIMICA_CONCOMITANTE
}

enum InternshipModality {
  PRESENCIAL
  REMOTO
}

enum InternshipStatus {
  IN_ANALYSIS
  APPROVED
  IN_PROGRESS
  FINISHED
  CANCELED
}

enum InternshipType {
  DIRECT
  INTEGRATOR
}

enum DocumentType {
  TCE
  PAE
  PERIODIC_REPORT
  TRE
  RFE
  SIGNED_CONTRACT
  LIFE_INSURANCE
}

enum DocumentStatus {
  PENDING_ANALYSIS
  APPROVED
  REJECTED
  SIGNED_VALIDATED
}

enum VacancyType {
  INTERNSHIP
  JOB
}

enum VacancyStatus {
  PENDING_APPROVAL
  APPROVED
  REJECTED
  CLOSED_BY_COMPANY
}

enum VacancyModality {
  PRESENCIAL
  HIBRIDO
  REMOTO
}
